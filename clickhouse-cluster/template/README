# Running cluster guide

If you want to debugging uncomment the .env files `ASM_CH_LOGGER_LEVEL` and `ASM_CH_RAFT_LOGS_LEVEL`.

Start with `docker-compose up -d`

Then create database and tables:

```bash
docker exec -it analytics-clickhouse bash -c 'clickhouse-client --multiquery < /schema.sql'
```

For using client:

```bash
docker exec -it analytics-clickhouse clickhouse-client --vertical -d analytics
```

For protecting ports and using firewall ensure you change ufw configure with docker properly

https://github.com/chaifeng/ufw-docker#solving-ufw-and-docker-issues

then run

```bash
systemctl restart ufw
ufw -f reset
cat ufw.docker >> /etc/ufw/after.rules
ufw default deny incoming
ufw default allow outgoing
ufw allow ssh
ufw allow 80/tcp
ufw allow 443/tcp
ufw -f enable
bash ufw.sh
ufw -f reload
```
